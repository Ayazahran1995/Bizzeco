<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BizzEco - Learn About Sustainable Brands</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Modern Natural Color Palette */
        :root {
            --primary: #346751; /* Rich Forest Green */
            --primary-light: #5a8d7c; /* Lighter variant for hover states */
            --primary-dark: #275342; /* Darker variant */
            --secondary: #c8a27e; /* Warm Terracotta/Sand */
            --accent: #dd6e42; /* Warm Terracotta for highlights/accents */
            --background: #f8f7f4; /* Off-white with slight warm tone */
            --card-bg: #ffffff; /* Pure white for cards */
            --text: #333f4c; /* Deep blue-gray for text */
            --text-light: #687685; /* Lighter variant for secondary text */
            --correct: #4d9d74; /* Natural green for correct answers */
            --incorrect: #e15554; /* Muted red for incorrect */
            --feedback-bg: #f3f6f9; /* Cool light blue-gray for feedback */
            --feedback-text: #394b59; /* Darker slate for feedback text */
            --border: #e2e4e8; /* Subtle border color */
            --shadow: 0 8px 24px rgba(149, 157, 165, 0.1); /* Subtle shadow */
            --transition: all 0.3s ease; /* Smooth transitions */
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Plus Jakarta Sans', sans-serif;
        }

        body {
            background-color: var(--background);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden; /* Prevent horizontal scroll from confetti */
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Outfit', sans-serif;
            font-weight: 600;
            letter-spacing: -0.02em;
        }

        .container {
            max-width: 920px;
            margin: 0 auto;
            padding: 30px 20px;
            position: relative; /* For confetti */
            z-index: 1;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
            border-bottom: 2px solid var(--border);
            margin-bottom: 36px;
            flex-wrap: wrap;
        }

        .logo {
            font-size: 26px;
            font-weight: 700;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
            font-family: 'Outfit', sans-serif;
            letter-spacing: -0.03em;
        }

        .logo-emoji {
            font-size: 30px;
            animation: float 4s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

         @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-15px); }
            60% { transform: translateY(-8px); }
        }


        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes slideIn {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .character {
            font-size: 70px;
            margin: 0 auto 32px;
            display: block;
            text-align: center;
            /* Default animation */
            animation: float 4s ease-in-out infinite;
            filter: drop-shadow(0 5px 15px rgba(0,0,0,0.1));
        }

        .character.happy {
            animation: bounce 2s infinite;
        }

        .character.thinking {
            animation: pulse 3s infinite;
        }

        .character.celebrating {
            animation: spin 3s infinite;
        }

        .progress-container {
            width: 100%;
            height: 12px;
            background-color: rgba(52,103,81,0.1);
            border-radius: 24px;
            margin: 20px 0 36px;
            overflow: hidden;
            position: relative;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary) 0%, var(--primary-light) 100%);
            border-radius: 24px;
            width: 0%;
            transition: width 0.7s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
        }

        .progress-bar::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transform: translateX(-100%);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            100% {
                transform: translateX(100%);
            }
        }

        .brand-select {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
            margin-bottom: 40px;
        }

        .brand-select h2 {
            grid-column: 1 / -1;
            text-align: center;
            margin-bottom: 24px;
            font-weight: 700;
            color: var(--primary);
            font-size: 26px;
        }

        .brand-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 28px 24px;
            box-shadow: var(--shadow);
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
            animation: fadeIn 0.5s ease;
            border: 1px solid var(--border);
            position: relative;
            overflow: hidden;
        }

        .brand-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary) 0%, var(--accent) 100%);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.4s ease;
        }

        .brand-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 14px 28px rgba(149, 157, 165, 0.15);
        }

        .brand-card:hover::before {
            transform: scaleX(1);
        }

        .brand-card img {
            width: 100%;
            height: 150px;
            object-fit: contain;
            margin-bottom: 16px;
        }

        .brand-emoji {
            font-size: 48px;
            margin-bottom: 16px;
            filter: drop-shadow(0 5px 10px rgba(0,0,0,0.08));
            transition: transform 0.5s ease;
        }

        .brand-card:hover .brand-emoji {
            transform: scale(1.15);
        }

        .brand-card h3 {
            font-size: 22px;
            margin-bottom: 12px;
            color: var(--primary-dark);
            font-weight: 600;
        }

        .brand-card p {
            color: var(--text-light);
            font-size: 15px;
            line-height: 1.5;
        }

        .lesson-container, .quiz-container, .result-container, .welcome-container {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 36px 32px;
            box-shadow: var(--shadow);
            margin-bottom: 32px;
            display: none;
            animation: slideIn 0.5s ease;
            border: 1px solid var(--border);
        }

        .welcome-container {
            text-align: center;
            max-width: 650px;
            margin: 50px auto;
            display: block; /* Show initially */
        }

        .btn {
            background: linear-gradient(90deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: var(--transition);
            display: inline-block;
            margin-top: 24px;
            box-shadow: 0 4px 12px rgba(52,103,81,0.2);
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-size: 15px;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 18px rgba(52,103,81,0.25);
            background: linear-gradient(90deg, var(--primary-dark) 0%, var(--primary) 100%);
        }

        .btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transform: translateX(-100%);
        }

        .btn:hover::after {
            animation: shimmer 1.5s infinite;
        }

         .btn:disabled {
             opacity: 0.6;
             cursor: not-allowed;
             transform: none;
             box-shadow: 0 4px 12px rgba(52,103,81,0.2); /* Keep initial shadow */
         }

         .btn:disabled:hover {
             background: linear-gradient(90deg, var(--primary) 0%, var(--primary-light) 100%); /* Prevent hover change */
             box-shadow: 0 4px 12px rgba(52,103,81,0.2); /* Prevent hover shadow */
             animation: none; /* Stop shimmer on hover */
         }

         .btn-secondary {
            background: linear-gradient(90deg, var(--secondary) 0%, #d8b596 100%);
            color: var(--text);
            box-shadow: 0 4px 12px rgba(200,162,126,0.2);
        }

        .btn-secondary:hover {
            background: linear-gradient(90deg, #b89472 0%, var(--secondary) 100%);
            box-shadow: 0 7px 18px rgba(200,162,126,0.25);
        }

        .quiz-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin: 28px 0;
        }

        .quiz-option {
            background: var(--feedback-bg);
            padding: 18px 20px;
            border-radius: 14px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            border: 2px solid transparent;
        }

        .quiz-option:hover {
            background: #e9eef4;
            transform: translateY(-3px);
            border-color: rgba(52,103,81,0.1);
        }

        .quiz-option.selected {
            background: rgba(52,103,81,0.08);
            border-color: var(--primary);
            font-weight: 500;
        }

         .quiz-option.disabled {
             pointer-events: none; /* Disable clicks after answer */
             opacity: 0.8; /* Slightly dim disabled options */
         }


        .option-emoji {
            margin-right: 12px;
            font-size: 24px;
            transition: transform 0.3s ease;
        }

        .quiz-option:hover .option-emoji {
            transform: scale(1.2);
        }

        .correct {
            background: rgba(77, 157, 116, 0.15) !important;
            border-color: var(--correct) !important;
            position: relative;
        }

        .correct::after {
            content: "‚úì";
            position: absolute;
            right: 20px;
            font-size: 20px;
            color: var(--correct);
            font-weight: bold;
        }

        .incorrect {
            background: rgba(225, 85, 84, 0.1) !important;
            border-color: var(--incorrect) !important;
            position: relative;
        }

        .incorrect::after {
            content: "‚úó";
            position: absolute;
            right: 20px;
            font-size: 20px;
            color: var(--incorrect);
            font-weight: bold;
        }

        .hidden {
            display: none !important;
        }

        .score-display {
            font-size: 18px;
            font-weight: 600;
            text-align: center;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            background: rgba(52,103,81,0.08);
            padding: 8px 16px;
            border-radius: 30px;
        }

        .score-emoji {
            font-size: 22px;
            animation: pulse 2s infinite;
        }

        #userGreeting {
            font-size: 16px;
            font-weight: 500;
            color: var(--primary);
            text-align: right;
            margin-bottom: 6px;
            width: 100%;
        }

        #quizFeedback {
            margin-top: 24px;
            padding: 20px;
            background-color: var(--feedback-bg);
            color: var(--feedback-text);
            border-radius: 14px;
            display: none;
            animation: fadeIn 0.5s ease;
            border-left: 4px solid var(--primary);
        }

         #quizFeedback strong {
             color: var(--primary-dark);
             font-weight: 600;
         }


        .lesson-image {
            width: 100%;
            height: 220px;
            object-fit: contain;
            background: rgba(52,103,81,0.05);
            border-radius: 14px;
            margin: 24px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .lesson-image img {
            max-width: 100%;
            max-height: 100%;
            transition: transform 0.5s ease;
        }

        .lesson-image:hover img {
            transform: scale(1.05);
        }

        h2 {
            color: var(--primary-dark);
            margin-bottom: 18px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 24px;
        }

        .title-emoji {
            font-size: 26px;
            display: inline-block;
            animation: pulse 2s infinite;
        }

        p {
            margin-bottom: 16px;
            color: var(--text);
            font-size: 16px;
            line-height: 1.7;
        }

        #lessonContent p {
            margin-bottom: 20px;
        }

        strong, b {
            color: var(--primary-dark);
            font-weight: 600;
        }

         /* Styling for highlighted text - simplified without :contains */
         #lessonContent .highlight-e {
             color: var(--correct);
         }
         #lessonContent .highlight-e::before {
             background-color: rgba(77,157,116,0.15);
         }

         #lessonContent .highlight-s {
             color: #6a7fc8;
         }
          #lessonContent .highlight-s::before {
             background-color: rgba(106,127,200,0.15);
         }

         #lessonContent .highlight-g {
             color: #9059b8;
         }
          #lessonContent .highlight-g::before {
             background-color: rgba(144,89,184,0.15);
         }
        #lessonContent .highlight-e, 
#lessonContent .highlight-s, 
#lessonContent .highlight-g {
    position: relative;
    z-index: 1;
    padding: 0 3px;
}

#lessonContent .highlight-e::before, 
#lessonContent .highlight-s::before, 
#lessonContent .highlight-g::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    border-radius: 4px;
}


        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: linear-gradient(135deg, var(--secondary) 0%, var(--accent) 100%);
            animation: confetti 5s ease-in-out infinite;
            z-index: 999;
            top: -10px;
            border-radius: 2px;
            pointer-events: none; /* Don't block clicks */
        }

        @keyframes confetti {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }

        .feedback-emoji {
            font-size: 70px;
            display: block;
            text-align: center;
            margin: 30px 0;
            animation: bounce 2s infinite;
            filter: drop-shadow(0 5px 15px rgba(0,0,0,0.1));
        }

        .welcome-container .character {
            font-size: 90px;
            margin-bottom: 20px;
        }

        .welcome-container input[type="text"] {
            padding: 16px 20px;
            margin: 24px auto;
            border: 2px solid var(--border);
            border-radius: 14px;
            font-size: 16px;
            width: 80%;
            max-width: 350px;
            display: block;
            transition: var(--transition);
            background: rgba(255,255,255,0.8);
        }

        .welcome-container input[type="text"]:focus {
            outline: none;
            border-color: var(--primary-light);
            box-shadow: 0 0 0 4px rgba(52,103,81,0.1);
            background: #fff;
        }

        .result-container .score-display {
            font-size: 24px;
            margin: 20px auto;
            display: inline-flex;
            padding: 14px 30px;
            background: linear-gradient(90deg, rgba(52,103,81,0.1) 0%, rgba(77,157,116,0.1) 100%);
        }

        header > div:last-child {
            text-align: right;
            margin-left: auto;
        }

        .brand-logo {
            background: rgba(52,103,81,0.05);
            padding: 20px;
            border-radius: 14px;
            height: 180px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 22px;
        }


        /* Mobile styles */
        @media (max-width: 768px) {
            .quiz-options {
                grid-template-columns: 1fr;
            }

            .brand-select {
                display: flex;
                flex-direction: column;
            }

            .brand-card {
                width: 100%;
                max-width: 380px;
                margin: 0 auto;
            }

            header {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }

            header > div:last-child {
                margin-left: 0;
                width: 100%;
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-top: 8px;
            }

            #userGreeting {
                text-align: left;
            }

            .score-display {
                justify-content: flex-end;
            }

            .lesson-container, .quiz-container, .result-container, .welcome-container {
                padding: 24px 20px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 16px 12px;
            }

            .character {
                font-size: 60px;
            }

            .welcome-container .character {
                font-size: 70px;
            }

            .feedback-emoji {
                font-size: 60px;
            }

            header > div:last-child {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }

            .score-display {
                justify-content: flex-start;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-emoji">üå±</div>
                BizzEco
            </div>
            <div>
                <div id="userGreeting"></div>
                <div class="score-display">
                    <div class="score-emoji">‚ú®</div>
                    Score: <span id="score">0</span>
                </div>
            </div>
        </header>

        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>

        <div id="welcomeContainer" class="welcome-container">
            <div class="character">üëã</div>
            <h2>Welcome to BizzEco!</h2>
            <p>Learn about amazing brands leading the way in sustainability. Understanding these businesses is key to building a more sustainable future, and it's the foundation for <strong>sustainable finance</strong> ‚Äì directing money towards positive impact! üåçüí∞</p>
            <p>Enter your name to save your progress:</p>
            <input type="text" id="userNameInput" placeholder="Your Name">
            <button class="btn" onclick="startApp()">Let's Start! <span class="title-emoji">üöÄ</span></button>
        </div>


        <div id="brandSelect" class="brand-select hidden">
            <h2>
                <span class="title-emoji">üåç</span> Choose a brand to learn about
            </h2>
            <div class="brand-card" onclick="selectBrand('patagonia')">
                <div class="brand-emoji">üèîÔ∏è</div>
                <h3>Patagonia</h3>
                <p>Learn about Patagonia's environmental activism and sustainable business practices.</p>
            </div>
            <div class="brand-card" onclick="selectBrand('tonys')">
                <div class="brand-emoji">üç´</div>
                <h3>Tony's Chocolonely</h3>
                <p>Discover how Tony's is working to make chocolate 100% slave-free.</p>
            </div>
        </div>

        <div id="lessonContainer" class="lesson-container hidden">
            <div class="character thinking" id="lessonCharacter">ü§î</div>
            <h2 id="lessonTitle"></h2>
            <div class="lesson-image" id="lessonImage">
                <img src="" alt="Lesson Illustration">
            </div>
            <div id="lessonContent"></div>
             <button class="btn" id="finishLessonBtn" onclick="nextLesson()">Next Lesson <span class="title-emoji">‚û°Ô∏è</span></button>
        </div>

        <div id="quizContainer" class="quiz-container hidden">
            <div class="character" id="quizCharacter">üßê</div>
            <h2><span class="title-emoji">‚ùì</span> Quick Quiz</h2>
            <p id="quizQuestion"></p>
            <div class="quiz-options" id="quizOptions">
                </div>
            <div id="quizFeedback" class="hidden"></div>
            <button class="btn hidden" id="checkAnswerBtn" onclick="checkAnswer()">Check Answer <span class="title-emoji">‚úì</span></button>
            <button class="btn hidden" id="nextQuestionBtn" onclick="nextQuestion()">Next <span class="title-emoji">‚û°Ô∏è</span></button>
        </div>

        <div id="resultContainer" class="result-container hidden">
            <div class="character happy" id="resultCharacter">üéâ</div>
            <h2><span class="title-emoji">üèÜ</span> Great job!</h2>
            <div class="score-display">You scored: <span id="finalScore"></span>%</div>
            <div id="feedbackEmoji" class="feedback-emoji"></div>
            <p id="resultFeedback"></p>

             <p style="margin-top: 25px;">
                 By learning about brands like Patagonia and Tony's Chocolonely, you're gaining insight into how businesses can prioritize people and the planet through strong ESG practices. ‚ú® This knowledge is valuable for everyone, especially as we think about a sustainable future, not just on Earth Day, but every day! üå±
             </p>

            <button class="btn" onclick="returnToHome()">Learn More Brands <span class="title-emoji">üîÑ</span></button>
        </div>
    </div>

    <script>
        // App State
        const state = {
            userName: null,
            currentBrand: null,
            currentLessonIndex: 0,
            currentQuizIndex: 0,
            score: 0, // Score for the current brand's quiz
            totalQuestions: 0,
            correctAnswers: 0,
            selectedOptionIndex: null,
            quizData: [] // Shuffled quiz questions for the current brand
        };

        // Brand Content (Includes quiz questions and explanations)
        const brands = {
            patagonia: {
                name: "Patagonia",
                emoji: "üèîÔ∏è",
                characterEmojis: ["üßó‚Äç‚ôÄÔ∏è", "üå≤", "üèûÔ∏è", "üß†", "üßê", "ü•≥"], // Welcome, Lessons 1, 2, 3, Quiz, Result
                lessons: [
                    {
                        title: "Patagonia's Mountain Mission",
                        emoji: "üìö",
                        image: "https://upload.wikimedia.org/wikipedia/commons/thumb/1/17/Patagonia%27s_Flag.png/800px-Patagonia%27s_Flag.png", // Placeholder Image URL
                        content: `<p>Meet Yvon Chouinard, the climber who started Patagonia in 1973! üßó‚Äç‚ôÇÔ∏è His mission wasn't just selling gear, but using business to "save our home planet." [1]</p>
                         <p>Right from the start, they focused on making durable stuff you can repair, fighting against throwaway culture. (That's a core <strong class="highlight-e">Environmental (E)</strong> principle!) ‚ôªÔ∏è</p>
                         <p>In a wild move in 2022, Chouinard gave away the company! All profits not reinvested go to fighting climate change. [2] (Talk about baked-in <strong class="highlight-g">Governance (G)</strong> for impact!) üå±</p>`
                    },
                    {
                        title: "Gear Up Sustainably",
                        emoji: "üßµ",
                        image: "https://www.patagonia.com/static/on/demandware.static/-/Library-Sites-patagonia/default/dw55b4e3b1/images/wornwear/wornwear-masthead-2560.jpg", // Placeholder Image URL
                        content: `<p>Patagonia pioneered using recycled materials! Think jackets from plastic bottles üç∂, plus recycled wool and organic cotton. (Huge <strong class="highlight-e">Environmental (E)</strong> wins here!) [3]</p>
                         <p>Lost a button? Tore your jacket? Their Worn Wear program encourages repair over replacement. They even have a massive repair center! [4] (Extending product life is key <strong class="highlight-e">Environmental (E)</strong> action.) üß©</p>
                         <p>They switched to 100% organic cotton back in 1996, avoiding toxic pesticides. [5] (Another example of prioritizing <strong class="highlight-e">Environmental (E)</strong> health in their <strong class="highlight-s">Supply Chain</strong> - the journey materials take from source to product.) üåø</p>`
                    },
                    {
                        title: "Activist for Earth",
                        emoji: "‚úä",
                        image: "https://www.patagonia.com/static/on/demandware.static/-/Library-Sites-patagonia/default/dw79984785/images/press/2022/Pata_Yosemite_Activism_2022_Masthead.jpg", // Placeholder Image URL
                        content: `<p>Patagonia gives 1% of ALL sales to environmental groups. That's based on revenue, not just profit! [6] (Direct <strong class="highlight-e">Environmental (E)</strong> funding & a bold <strong class="highlight-s">Social (S)</strong> statement!) üíö</p>
                         <p>They don't shy away from a fight, even suing governments to protect public lands. [7] (Using their voice for environmental protection - a powerful <strong class="highlight-e">Environmental (E)</strong> stance.) ‚öñÔ∏è</p>
                         <p>They also make films about environmental issues, spreading awareness far and wide. üé¨ (Raising public awareness is both a <strong class="highlight-s">Social (S)</strong> and <strong class="highlight-e">Environmental (E)</strong> contribution.)</p>`
                    },
                     // --- CONCLUDING LESSON (Same for all brands) ---
                     {
                         title: "Beyond the Product: The Double View!",
                         emoji: "üí°", // Lightbulb emoji
                         image: "https://sustainability.uq.edu.au/files/5876/stacked-esg-pillars-colour.jpg", // Placeholder Image URL
                         content: `<p>So, what's the big takeaway from brands like Patagonia and Tony's? We see <strong >how</strong> businesses <em>operate</em> in the world and the impact that creates ‚Äì from their <strong class="highlight-e">carbon footprint</strong> and waste (<strong class="highlight-e">E</strong>), to how they treat workers (<strong class="highlight-s">S</strong>), to how openly they run things (<strong class="highlight-g">G</strong>).</p>
                         <p>These aren't just 'nice' things to do; managing this impact is a core part of responsible business today!</p>
                         <p>Here's the cool part: the world also impacts businesses! Climate change, social issues, or customers who care can affect a company's costs, reputation, and future success. üí∞üåç</p>
                         <p>Smart businesses understand this <strong >"double view"</strong> ‚Äì how their actions create impact AND how the world affects their business financially. They actively manage their impact AND prepare for a changing future.</p>
                         <p>Now, let's test your knowledge!</p>`
                     }
                ],
                quiz: [
                    {
                        question: "Patagonia is known for encouraging customers to repair gear instead of buying new. This aligns most closely with which ESG principle?",
                        options: ["Environmental (E)", "Social (S)", "Governance (G)"],
                        correctAnswer: 0, // Index of the correct option
                        explanation: "Encouraging repair reduces waste and extends the life of products, directly contributing to environmental sustainability."
                    },
                    {
                        question: "In 2022, Yvon Chouinard gave away ownership of Patagonia, directing profits to fight climate change. This action primarily demonstrates a commitment to which ESG principle?",
                        options: ["Environmental (E)", "Social (S)", "Governance (G)"],
                        correctAnswer: 2,
                        explanation: "The decision about company ownership and profit distribution relates to how the company is run and for whose benefit, which falls under Governance."
                    },
                    {
                        question: "Patagonia gives 1% of its sales (revenue) to environmental groups. This is an example of:",
                        options: ["Shareholder dividends", "Environmental (E) funding", "Social (S) activism"],
                        correctAnswer: 1,
                        explanation: "Directly funding environmental organizations from revenue is a clear commitment to environmental (E) impact."
                    },
                     {
                        question: "The 'Double View' discussed in the final lesson refers to understanding:",
                        options: ["How a business impacts the world and how the world impacts the business", "How much profit a business makes and how much it spends on marketing", "How many products a business sells and how many employees it has"],
                        correctAnswer: 0,
                        explanation: "The 'Double View' in sustainable business means understanding both the impact a company has *on* the environment and society, and the financial and operational risks/opportunities that external environmental and social factors have *on* the company."
                    }
                ]
            },
            tonys: {
                name: "Tony's Chocolonely",
                emoji: "üç´",
                characterEmojis: ["üïµÔ∏è‚Äç‚ôÄÔ∏è", "‚öñÔ∏è", "ü§ù", "üß†", "üßê", "ü•≥"], // Welcome, Lessons 1, 2, 3, Quiz, Result
                lessons: [
                    {
                        title: "Tony's Sweet Mission",
                        emoji: "üìö",
                        image: "https://tonyschocolonely.com/media/filer_public/2a/42/2a42f011-1729-4419-9e3c-6082f05c33a5/tonys_website_header_small.jpg", // Placeholder Image URL
                        content: `<p>Did you know that slavery still exists in the chocolate industry? üíî Tony's Chocolonely was started in 2005 by three journalists who wanted to expose this issue and make 100% slave-free chocolate the norm. [8]</p>
                         <p>Their mission isn't just about their own chocolate bar; it's about changing the entire industry. (This big-picture goal is part of their <strong class="highlight-s">Social (S)</strong> impact strategy!) üåê</p>
                         <p>They work directly with cocoa farmers, paying them a higher price and investing in farming communities. (Fair wages and community support are key <strong class="highlight-s">Social (S)</strong> actions in their <strong class="highlight-s">Supply Chain</strong>.) üßë‚Äçüåæüí∞</p>`
                    },
                    {
                        title: "Five Sourcing Principles",
                        emoji: "üñêÔ∏è",
                        image: "https://tonyschocolonely.com/media/filer_public/c0/e6/c0e685f1-e749-4a08-a633-5e2c99ef809a/open_chain_principes.png", // Placeholder Image URL
                        content: `<p>Tony's has Five Sourcing Principles to ensure their chocolate is slave-free and ethical: from using 100% traceable beans to paying a Living Income Reference Price. [9] (These clear guidelines are part of their <strong class="highlight-g">Governance (G)</strong> and <strong class="highlight-s">Social (S)</strong> framework.) ‚úÖ</p>
                         <p>They even publish an annual report detailing their progress and challenges, being super transparent about their supply chain. [10] (Transparency is a key aspect of good <strong class="highlight-g">Governance (G)</strong> and builds trust.) üìà</p>
                         <p>While their main focus is <strong class="highlight-s">Social (S)</strong> issues in the supply chain, they also consider <strong class="highlight-e">Environmental (E)</strong> impacts like deforestation and packaging. (They aim for positive impact across the board!) üå≥üì¶</p>`
                    },
                    {
                        title: "Sweet Success, Serious Purpose",
                        emoji: "ü•≥",
                        image: "https://tonyschocolonely.com/media/filer_public/a6/2e/a62e3178-b102-4a32-8297-379f86a2b731/tonys_website_impact_header.jpg", // Placeholder Image URL
                        content: `<p>Tony's unique, unevenly divided chocolate bar is a symbol of the inequality in the chocolate industry. (A clever way to raise <strong class="highlight-s">Social (S)</strong> awareness with their product design!) üç´‚û°Ô∏è</p>
                         <p>They don't just keep their sourcing methods secret; they invite other chocolate companies to join their "Open Chain" initiative to share knowledge and scale up impact. [11] (Collaborating for industry-wide change is powerful <strong class="highlight-s">Social (S)</strong> leadership!) ü§ù</p>
                         <p>By showing that a profitable business can be built on ethical principles, Tony's inspires consumers and other businesses to demand and create more sustainable supply chains. (Their success is a win for <strong class="highlight-s">Social (S)</strong> responsibility and a good example of how strong <strong class="highlight-g">Governance (G)</strong> enables positive impact.) üåü</p>`
                    },
                    // --- CONCLUDING LESSON (Same for all brands) ---
                    {
                        title: "Beyond the Product: The Double View!",
                        emoji: "üí°", // Lightbulb emoji
                         image: "https://sustainability.uq.edu.au/files/5876/stacked-esg-pillars-colour.jpg", // Placeholder Image URL
                        content: `<p>So, what's the big takeaway from brands like Patagonia and Tony's? We see <strong >how</strong> businesses <em>operate</em> in the world and the impact that creates ‚Äì from their <strong class="highlight-e">carbon footprint</strong> and waste (<strong class="highlight-e">E</strong>), to how they treat workers (<strong class="highlight-s">S</strong>), to how openly they run things (<strong class="highlight-g">G</strong>).</p>
                         <p>These aren't just 'nice' things to do; managing this impact is a core part of responsible business today!</p>
                         <p>Here's the cool part: the world also impacts businesses! Climate change, social issues, or customers who care can affect a company's costs, reputation, and future success. üí∞üåç</p>
                         <p>Smart businesses understand this <strong >"double view"</strong> ‚Äì how their actions create impact AND how the world affects their business financially. They actively manage their impact AND prepare for a changing future.</p>
                         <p>Now, let's test your knowledge!</p>`
                    }
                ],
                quiz: [
                     {
                         question: "Tony's Chocolonely was founded primarily to address which issue in the chocolate industry?",
                         options: ["High sugar content", "Slave labor", "Artificial flavors"],
                         correctAnswer: 1,
                         explanation: "Tony's mission is specifically focused on eradicating modern slavery and illegal child labor in the cocoa supply chain."
                     },
                     {
                         question: "Tony's publishes an annual report detailing their progress and challenges in their supply chain. This is an example of:",
                         options: ["Marketing strategy", "Transparency and Governance (G)", "Environmental (E) reporting"],
                         correctAnswer: 1,
                         explanation: "Being open about their operations, progress, and challenges demonstrates transparency, a key aspect of good Governance."
                     },
                     {
                         question: "Tony's pays cocoa farmers a higher price (Living Income Reference Price) and invests in communities. This primarily addresses which ESG principle?",
                         options: ["Environmental (E)", "Social (S)", "Governance (G)"],
                         correctAnswer: 1,
                         explanation: "Fair wages, community investment, and improving farmer livelihoods are core components of Social responsibility."
                     },
                     {
                         question: "The 'Double View' discussed in the final lesson refers to understanding:",
                         options: ["How a business impacts the world and how the world impacts the business", "How much profit a business makes and how much it spends on marketing", "How many products a business sells and how many employees has it has"],
                         correctAnswer: 0,
                         explanation: "The 'Double View' in sustainable business means understanding both the impact a company has *on* the environment and society, and the financial and operational risks/opportunities that external environmental and social factors have *on* the company."
                     }
                ]
            }
            // Add more brands here following the same structure
        };

        // DOM Elements
        const welcomeContainer = document.getElementById('welcomeContainer');
        const userNameInput = document.getElementById('userNameInput');
        const userGreeting = document.getElementById('userGreeting');
        const brandSelect = document.getElementById('brandSelect');
        const lessonContainer = document.getElementById('lessonContainer');
        const lessonCharacter = document.getElementById('lessonCharacter');
        const lessonTitle = document.getElementById('lessonTitle');
        const lessonImage = document.getElementById('lessonImage');
        const lessonContent = document.getElementById('lessonContent');
        const finishLessonBtn = document.getElementById('finishLessonBtn');
        const quizContainer = document.getElementById('quizContainer');
        const quizCharacter = document.getElementById('quizCharacter');
        const quizQuestion = document.getElementById('quizQuestion');
        const quizOptions = document.getElementById('quizOptions');
        const quizFeedback = document.getElementById('quizFeedback');
        const checkAnswerBtn = document.getElementById('checkAnswerBtn');
        const nextQuestionBtn = document.getElementById('nextQuestionBtn');
        const resultContainer = document.getElementById('resultContainer');
        const resultCharacter = document.getElementById('resultCharacter');
        const finalScoreDisplay = document.getElementById('finalScore');
        const feedbackEmoji = document.getElementById('feedbackEmoji');
        const resultFeedback = document.getElementById('resultFeedback');
        const scoreDisplay = document.getElementById('score');
        const progressBar = document.getElementById('progressBar');

        // --- App Flow Functions ---

        function startApp() {
            console.log("startApp function called");
            const name = userNameInput.value.trim();
            if (name) {
                state.userName = name;
                userGreeting.textContent = `Hello, ${state.userName}!`;
                welcomeContainer.classList.add('hidden');
                brandSelect.classList.remove('hidden');
                updateProgressBar();
                console.log("App started, showing brand select.");
            } else {
                alert("Please enter your name to start!");
                console.log("Name input empty, showing alert.");
            }
        }

        function selectBrand(brandKey) {
            console.log(`selectBrand function called with key: ${brandKey}`);
            state.currentBrand = brandKey;
            state.currentLessonIndex = 0;
            state.score = 0;
            state.correctAnswers = 0; // Reset correct answers for quiz
            state.totalQuestions = brands[brandKey].quiz.length;
            brandSelect.classList.add('hidden');
            lessonContainer.classList.remove('hidden');
            displayLesson();
            updateScoreDisplay();
            updateProgressBar();
             console.log(`Brand '${brandKey}' selected, showing first lesson.`);
        }

        function displayLesson() {
            console.log(`displayLesson function called for lesson index: ${state.currentLessonIndex}`);
            const brand = brands[state.currentBrand];
            const lesson = brand.lessons[state.currentLessonIndex];

            lessonTitle.innerHTML = `<span class="title-emoji">${lesson.emoji}</span> ${lesson.title}`;
            // Cycle through character emojis based on lesson index
            lessonCharacter.textContent = brand.characterEmojis[state.currentLessonIndex % (brand.characterEmojis.length - 2)] || 'ü§î'; // Exclude last two for quiz/result
            lessonImage.innerHTML = `<img src="${lesson.image}" alt="${lesson.title} illustration">`; // Set image source
            lessonContent.innerHTML = lesson.content;

            // Hide "Next Lesson" button on the last lesson
            if (state.currentLessonIndex === brand.lessons.length - 1) {
                 finishLessonBtn.textContent = `Start Quiz ${brand.emoji}`;
                 finishLessonBtn.onclick = () => startQuiz(state.currentBrand);
                 console.log("Displayed last lesson, button set to Start Quiz.");
            } else {
                 const nextLessonEmoji = brand.characterEmojis[(state.currentLessonIndex + 1) % (brand.characterEmojis.length - 2)] || '‚û°Ô∏è';
                 finishLessonBtn.textContent = `Next Lesson ${nextLessonEmoji}`;
                 finishLessonBtn.onclick = nextLesson;
                 console.log(`Displayed lesson ${state.currentLessonIndex}, button set to Next Lesson.`);
            }
             finishLessonBtn.disabled = false; // Enable button
        }

        function nextLesson() {
             console.log("nextLesson function called.");
             finishLessonBtn.disabled = true; // Disable button while transitioning
             state.currentLessonIndex++;
             const brand = brands[state.currentBrand];
             if (state.currentLessonIndex < brand.lessons.length) {
                 displayLesson();
                 updateProgressBar();
             } else {
                 // This case should ideally be handled by the button switching to startQuiz
                 startQuiz(state.currentBrand);
             }
        }

        function startQuiz(brandKey) {
            console.log(`startQuiz function called for brand: ${brandKey}`);
            state.currentQuizIndex = 0;
            state.selectedOptionIndex = null;
            state.correctAnswers = 0; // Reset correct answers for the quiz session

            // Shuffle quiz questions
            state.quizData = [...brands[brandKey].quiz].sort(() => 0.5 - Math.random());
            state.totalQuestions = state.quizData.length; // Update total questions based on shuffled list

            lessonContainer.classList.add('hidden');
            quizContainer.classList.remove('hidden');
            displayQuestion();
            updateProgressBar();
            console.log("Quiz started, showing first question.");
        }


        function displayQuestion() {
            console.log(`displayQuestion function called for question index: ${state.currentQuizIndex}`);
            const questionData = state.quizData[state.currentQuizIndex];
            quizQuestion.textContent = questionData.question;
            quizOptions.innerHTML = ''; // Clear previous options
            quizFeedback.classList.add('hidden');
            checkAnswerBtn.classList.add('hidden');
            nextQuestionBtn.classList.add('hidden');
            state.selectedOptionIndex = null; // Reset selected option

            // Set quiz character emoji
            const brand = brands[state.currentBrand];
            quizCharacter.textContent = brand.characterEmojis[4] || 'üßê'; // Use thinking/quiz emoji
            quizCharacter.classList.remove('happy', 'celebrating', 'thinking'); // Reset animations
            quizCharacter.classList.add('thinking');


            questionData.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.classList.add('quiz-option');
                optionElement.innerHTML = `<span class="option-emoji">${getOptionEmoji(index)}</span> ${option}`;
                optionElement.onclick = () => selectOption(index);
                quizOptions.appendChild(optionElement);
            });
             checkAnswerBtn.disabled = true; // Disable check button until option is selected
             console.log(`Displayed question ${state.currentQuizIndex + 1}.`);
        }

        function getOptionEmoji(index) {
             const emojis = ["A)", "B)", "C)", "D)"]; // Use letters as emojis
             return emojis[index] || '';
        }


        function selectOption(optionIndex) {
            console.log(`selectOption function called with index: ${optionIndex}`);
            // Remove selected class from all options
            quizOptions.querySelectorAll('.quiz-option').forEach(opt => {
                opt.classList.remove('selected');
            });

            // Add selected class to the clicked option
            quizOptions.children[optionIndex].classList.add('selected');
            state.selectedOptionIndex = optionIndex;
            checkAnswerBtn.classList.remove('hidden'); // Show check answer button
            checkAnswerBtn.disabled = false; // Enable check answer button
             console.log(`Option ${optionIndex} selected, Check Answer button enabled.`);
        }

        function checkAnswer() {
            console.log("checkAnswer function called.");
            if (state.selectedOptionIndex === null) {
                 console.log("No option selected, returning.");
                return; // Do nothing if no option is selected
            }

            checkAnswerBtn.disabled = true; // Disable check button after clicking


            const questionData = state.quizData[state.currentQuizIndex];
            const selectedOptionElement = quizOptions.children[state.selectedOptionIndex];
            const isCorrect = state.selectedOptionIndex === questionData.correctAnswer;

            // Disable all options after checking
            quizOptions.querySelectorAll('.quiz-option').forEach(opt => {
                 opt.classList.add('disabled');
            });


            // Provide feedback
            quizFeedback.classList.remove('hidden');
            if (isCorrect) {
                state.correctAnswers++;
                // Calculate score based on current question's worth
                state.score += Math.round(100 / state.totalQuestions);
                selectedOptionElement.classList.add('correct');
                quizFeedback.innerHTML = `<strong>Correct!</strong> ${questionData.explanation}`;
                 quizCharacter.textContent = brands[state.currentBrand].characterEmojis[5] || 'ü•≥'; // Celebrate
                 quizCharacter.classList.remove('thinking');
                 quizCharacter.classList.add('happy');
                 console.log("Answer correct, score updated.");
            } else {
                selectedOptionElement.classList.add('incorrect');
                 const correctAnswerElement = quizOptions.children[questionData.correctAnswer];
                 correctAnswerElement.classList.add('correct'); // Highlight the correct answer
                quizFeedback.innerHTML = `<strong>Incorrect.</strong> The correct answer was: ${questionData.options[questionData.correctAnswer]}. ${questionData.explanation}`;
                 quizCharacter.textContent = brands[state.currentBrand].characterEmojis[4] || 'ü§î'; // Back to thinking/quiz
                 quizCharacter.classList.remove('happy');
                 quizCharacter.classList.add('thinking');
                 console.log("Answer incorrect.");
            }

            updateScoreDisplay();
            checkAnswerBtn.classList.add('hidden'); // Hide check answer button
            nextQuestionBtn.classList.remove('hidden'); // Show next question button
            nextQuestionBtn.disabled = false; // Enable next button


             // Update progress bar immediately after checking
             updateProgressBar();
             console.log(`Answer checked. Is Correct: ${isCorrect}. Showing next question button.`);
        }

        function nextQuestion() {
            console.log("nextQuestion function called.");
             nextQuestionBtn.disabled = true; // Disable button while transitioning
            state.currentQuizIndex++;

            // Clear previous state
            quizFeedback.classList.add('hidden');
            checkAnswerBtn.classList.add('hidden');
            nextQuestionBtn.classList.add('hidden');
            quizOptions.innerHTML = ''; // Clear options


            if (state.currentQuizIndex < state.quizData.length) {
                displayQuestion();
                 console.log(`Moving to question ${state.currentQuizIndex + 1}.`);
            } else {
                showResult();
                 console.log("Quiz finished, showing results.");
            }
             updateProgressBar();
        }

        function showResult() {
            console.log("showResult function called.");
            quizContainer.classList.add('hidden');
            resultContainer.classList.remove('hidden');

            // Calculate final score percentage
            const finalScore = state.totalQuestions > 0 ? Math.round((state.correctAnswers / state.totalQuestions) * 100) : 0;
            finalScoreDisplay.textContent = finalScore;

             resultCharacter.textContent = brands[state.currentBrand].characterEmojis[5] || 'üéâ'; // Set result character emoji
             resultCharacter.classList.remove('thinking', 'happy', 'celebrating');
             resultCharacter.classList.add(finalScore === 100 ? 'celebrating' : 'happy');


            let resultText = "";
            let emoji = "üòê";
            if (finalScore === 100) {
                resultText = "Wow, perfect score! You're a sustainability superstar! üåü";
                emoji = "ü§©";
                triggerConfetti(); // Trigger confetti for a perfect score
            } else if (finalScore >= 70) {
                resultText = "Great job! You have a strong understanding of this brand's sustainable practices. Keep learning! üëç";
                emoji = "üòä";
            } else if (finalScore >= 40) {
                resultText = "You're getting there! Keep exploring and learning more about sustainable brands. üå±";
                emoji = "ü§î";
            } else {
                resultText = "Don't worry, sustainability is a journey! Review the lessons and try again. üí™";
                emoji = "üòÖ";
            }

            feedbackEmoji.textContent = emoji;
            resultFeedback.textContent = resultText;

            updateProgressBar();
             console.log(`Results displayed. Final Score: ${finalScore}%`);
        }

        function returnToHome() {
            console.log("returnToHome function called.");
            resultContainer.classList.add('hidden');
            brandSelect.classList.remove('hidden');
            // Reset core state for a new brand selection
            state.currentBrand = null;
            state.currentLessonIndex = 0;
            state.currentQuizIndex = 0;
            state.score = 0; // Reset overall score
            state.correctAnswers = 0;
            state.totalQuestions = 0;
            state.selectedOptionIndex = null;
            state.quizData = [];

            updateScoreDisplay(); // Reset score display
            updateProgressBar(); // Reset progress bar
             console.log("Returned to brand selection.");
        }

        // --- UI Update Functions ---

        function updateScoreDisplay() {
             console.log(`Updating score display: ${state.score}`);
            scoreDisplay.textContent = state.score;
        }

        function updateProgressBar() {
            let totalSteps = 0;
            let currentStep = 0;
            let progressPercentage = 0;

            if (state.userName) { // Check if user has started
                 if (state.currentBrand) {
                     const brand = brands[state.currentBrand];
                     const totalLessons = brand.lessons.length;
                     const totalQuizQuestions = brand.quiz.length;

                     // Define total steps in a flow (e.g., Select Brand -> Lessons -> Quiz -> Result)
                     totalSteps = 1 + totalLessons + totalQuizQuestions + 1; // Select Brand + Lessons + Questions + Result

                     // Calculate current step based on current screen and index
                     currentStep = 1; // Start after brand selection
                     currentStep += state.currentLessonIndex; // Add completed lessons

                     if (state.currentLessonIndex === totalLessons) {
                         currentStep += state.currentQuizIndex; // Add answered quiz questions

                         if (state.currentQuizIndex === totalQuizQuestions && quizContainer.classList.contains('hidden') && !resultContainer.classList.contains('hidden')) {
                              currentStep += 1; // Add step for finishing quiz/showing result
                         }
                     }

                     progressPercentage = (currentStep / totalSteps) * 100;
                     // Ensure progress doesn't exceed 100% or go below 0%
                     progressPercentage = Math.max(0, Math.min(100, progressPercentage));

                 } else {
                      // On Brand Select screen after entering name
                      totalSteps = 1 + (Object.keys(brands).reduce((sum, key) => sum + brands[key].lessons.length, 0) + Object.keys(brands).reduce((sum, key) => sum + brands[key].quiz.length, 0) + Object.keys(brands).length * 2); // Rough estimate for total potential journey
                      currentStep = 1; // Passed welcome
                       progressPercentage = 5; // Small progress indication after starting
                 }

            } else {
                 // On Welcome screen
                 progressPercentage = 0;
            }

            progressBar.style.width = `${progressPercentage}%`;
            console.log(`Progress Bar updated. Current Step: ${currentStep}, Total Steps: ${totalSteps}, Percentage: ${progressPercentage.toFixed(2)}%`);
        }


        // --- Confetti Effect ---
        function triggerConfetti() {
            console.log("Triggering confetti!");
            const confettiCount = 150; // Increased confetti count
            for (let i = 0; i < confettiCount; i++) {
                const confetti = document.createElement('div');
                confetti.classList.add('confetti');
                confetti.style.left = `${Math.random() * 100}vw`;
                confetti.style.animationDelay = `${Math.random() * 3}s`; // Increased delay range
                confetti.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 70%)`; // Random color
                 confetti.style.width = `${Math.random() * 8 + 4}px`; // Random size
                 confetti.style.height = `${Math.random() * 8 + 4}px`; // Random size
                 confetti.style.animationDuration = `${Math.random() * 4 + 3}s`; // Increased duration range
                 confetti.style.opacity = Math.random() * 0.7 + 0.3; // Random opacity
                 confetti.style.transform = `rotate(${Math.random() * 360}deg)`; // Initial random rotation

                document.body.appendChild(confetti);

                // Remove confetti after animation finishes
                confetti.addEventListener('animationend', () => {
                    confetti.remove();
                });
            }
        }


        // --- Initial Setup ---
        document.addEventListener('DOMContentLoaded', () => {
            console.log("DOM fully loaded. Initializing app.");
            // Initial state is welcome screen
            welcomeContainer.classList.remove('hidden');
            brandSelect.classList.add('hidden');
            lessonContainer.classList.add('hidden');
            quizContainer.classList.add('hidden');
            resultContainer.classList.add('hidden');

            updateScoreDisplay();
            updateProgressBar();

            // Optional: If you want the Enter key to trigger startApp in the name input
            userNameInput.addEventListener('keypress', function(event) {
                if (event.key === 'Enter') {
                    event.preventDefault(); // Prevent form submission
                    startApp();
                }
            });
        });

         // Note about content highlighting:
         // The CSS rules for :contains("Environmental"), etc., are not standard CSS.
         // A JavaScript approach is needed to add classes like 'highlight-e', 'highlight-s', 'highlight-g'
         // to the <strong> tags based on their content if you want that highlighting to work.
         // This code does NOT implement that JavaScript, only the CSS rules assuming classes exist.
         // I've added the CSS rules using classes (.highlight-e, .highlight-s, .highlight-g)
         // and updated the lesson content HTML to use these classes for demonstration.


    </script>
</body>
</html>
